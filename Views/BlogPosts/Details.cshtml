@model JCA_blog.Models.BlogPost
@using Blog.Models;

@{
    ViewBag.Title = "Details";
}

<h2>Details</h2>

<div>
    <h4>BlogPost</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.Created)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Created)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Updated)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Updated)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Title)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Title)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Slug)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Slug)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Body)
        </dt>

        <dd>
            @Html.Raw(Model.Body)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.MediaURL)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.MediaURL)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Published)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Published)
        </dd>
    </dl>
</div>
<p>
    @Html.ActionLink("Edit", "Edit", new { id = Model.Id }) |
    @Html.ActionLink("Back to List", "Index")
</p>



@if (User.Identity.IsAuthenticated)
{
    var comment = new Comment();
    <!--Comments-->
    using (Html.BeginForm("Create", "Comments", new { BlogId = Model.Id }, FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        @Html.Hidden("Comment.PostId", Model.Id)
        <div class="form-group rounded">
            <div class="row">
                <div class="col-md-10 mx-auto">
                    @Html.TextArea("Comment.Body", new { @class = "form-control", placeholder = "Leave comment here...", rows = "2" })
                </div>
                <div class="col-md-2 mx-auto">
                    <input type="submit" value="Comment" class="btn btn-rose" />
                </div>
            </div>
        </div>
    }
    if (Model.Comments != null)
    {
        foreach (var item in Model.Comments)
        {
            <div class="card">
                <div class="card-body">
                    @item.Body
                </div>
                <hr />
                <div class="card-footer">
                    <div class="col-lg-6 col-md-6">
                        @item.Created.ToString("MMM dd, yyyy")
                    </div>
                    <div class="col-lg-4 col-md-4 text-center">
                        @item.Author.FirstName  @item.Author.LastName
                    </div>
                    <div class="col-lg-2 col-md-2">
                        @if (User.IsInRole("Admin") || User.IsInRole("Moderator"))
                        {
                            <a class="btn btn-rose btn-fab btn-round" href="@Url.Action("Edit", "Comments", new { id = item.Id })"><i class="material-icons">edit</i></a>
                            <a class="btn btn-rose btn-fab btn-round" href="@Url.Action("Delete", "Comments", new { id = item.Id })"><i class="material-icons">delete</i></a>
                        }
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <h4>Start the Conversation by leaving a comment above!!!</h4>
    }
}
else
{
    <h4 class="text-center">Login or Register to see and leave comments</h4>
    <p class="text-center">@Html.ActionLink("Login", "Login", "Account", new { returnUrl = Url.Action("Details", "BlogPosts", new { Slug = Model.Slug }) }, new { @class = "btn btn-rose" })</p>
}